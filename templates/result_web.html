<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì™€ì¸ ì¶”ì²œ ê²°ê³¼</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='favicon.ico') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/result_styles.css') }}"
    />
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
  </head>
  <body>
    <p id="wine-name">ğŸ· {{ response.wine }}</p>
    <p id="wine-description">{{ response.description }}</p>
    <img id="wine-image" src="{{ response.image_url }}" alt="ì™€ì¸ ì´ë¯¸ì§€" />

    <button id="shareButton">ğŸˆê³µìœ </button>

    <!-- ê³µìœ  íŒì—… -->
    <div class="popup-overlay" id="popupOverlay"></div>
    <div class="share-popup" id="sharePopup">
      <h2>ê³µìœ í•˜ê¸°</h2>
      <div class="share-input-container">
        <input type="text" id="shareUrl" readonly />
        <button onclick="copyUrl()">ğŸ”—</button>
      </div>
      <button id="kakaoShareButton">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
      <button onclick="closePopup()">âŒ</button>
    </div>

    <script>
      document
        .getElementById('shareButton')
        .addEventListener('click', function () {
          document.getElementById('popupOverlay').style.display = 'block';
          document.getElementById('sharePopup').style.display = 'block';

          // í˜„ì¬ URL ì„¤ì •
          document.getElementById('shareUrl').value = window.location.href;
        });

      function closePopup() {
        document.getElementById('popupOverlay').style.display = 'none';
        document.getElementById('sharePopup').style.display = 'none';
      }

      function copyUrl() {
        var copyText = document.getElementById('shareUrl');
        copyText.select();
        document.execCommand('copy');
        alert('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }

      // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ë²„íŠ¼ ì„¤ì •
      Kakao.init('f917da4d87bab4b5f0df798f944b872c'); // ğŸ”¹ ì—¬ê¸°ì— ì¹´ì¹´ì˜¤ API í‚¤ ì…ë ¥ (https://developers.kakao.com/)
      document
        .getElementById('kakaoShareButton')
        .addEventListener('click', function () {
          Kakao.Share.sendDefault({
            objectType: 'feed',
            content: {
              title: 'ë‚´ê°€ ì„ íƒí•œ ì™€ì¸ ğŸ·',
              description:
                document.getElementById('wine-name').innerText +
                '\n' +
                document.getElementById('wine-description').innerText,
              imageUrl: document.getElementById('wine-image').src,
              link: {
                mobileWebUrl: window.location.href,
                webUrl: window.location.href,
              },
            },
          });
        });
    </script>
  </body>
</html>
